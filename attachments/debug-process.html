<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Process Word</title>
    <link rel="stylesheet" href="./css/detail.css">
</head>
<body>
    <button class="back-btn" onclick="window.close()">â† è¿”å›</button>
    
    <div class="card">
        <div class="header">
            <h1 class="word-title" id="wordTitle">Loading...</h1>
            <div class="pronunciation" id="pronunciation">Loading...</div>
            <div class="definition" id="definition">Loading...</div>
        </div>
        
        <div class="content">
            <div class="section">
                <h3>ğŸ” è°ƒè¯•ä¿¡æ¯</h3>
                <div id="debugOutput">
                    <p>æ­£åœ¨æ£€æŸ¥æ•°æ®åŠ è½½...</p>
                </div>
            </div>
            
            <div class="section etymology">
                <h3>ğŸŒ± è¯æ ¹è¯æº</h3>
                <div id="etymologyContent">ç­‰å¾…æ•°æ®...</div>
            </div>
            
            <div class="visual-demo" id="visualDemo">
                <div class="gear"></div>
                <div class="process-flow" id="processFlow">
                    <!-- åŠ¨æ€ç”Ÿæˆæµç¨‹æ­¥éª¤ -->
                </div>
                <p style="margin-top: 20px; color: #4a6b7a; font-size: 1.1em;" id="visualMemory">
                    <strong>Visual Memory:</strong> <span id="visualDescription">ç­‰å¾…æ•°æ®...</span>
                </p>
            </div>
            
            <div class="section story">
                <h3>ğŸ“– Memory Story</h3>
                <p id="memoryStory">ç­‰å¾…æ•°æ®...</p>
            </div>
            
            <div class="section examples">
                <h3>ğŸ“ Example Sentences</h3>
                <div id="examplesList">ç­‰å¾…æ•°æ®...</div>
            </div>
            
            <div class="section synonyms-antonyms">
                <div class="syn-ant-item">
                    <h4>Synonyms</h4>
                    <div class="word-list" id="synonymsList">ç­‰å¾…æ•°æ®...</div>
                </div>
                <div class="syn-ant-item">
                    <h4>Antonyms</h4>
                    <div class="word-list" id="antonymsList">ç­‰å¾…æ•°æ®...</div>
                </div>
            </div>
            
            <div class="section phrases">
                <h3>ğŸ”¤ å¸¸ç”¨çŸ­è¯­</h3>
                <div id="phrasesList">ç­‰å¾…æ•°æ®...</div>
            </div>
        </div>
    </div>

    <script src="./js/fallback-data.js"></script>
    <script>
        console.log('=== Debug Process é¡µé¢å¯åŠ¨ ===');
        
        // å¼ºåˆ¶åŠ è½½ Process å•è¯æ•°æ®
        async function debugLoadProcess() {
            const debugOutput = document.getElementById('debugOutput');
            let output = '<h4>è°ƒè¯•è¿‡ç¨‹ï¼š</h4>';
            
            try {
                // 1. æ£€æŸ¥å¤‡ç”¨æ•°æ®
                output += '<p>1. æ£€æŸ¥å¤‡ç”¨æ•°æ®...</p>';
                if (window.fallbackWordDetails && window.fallbackWordDetails['Process']) {
                    output += '<p>âœ… Process å¤‡ç”¨æ•°æ®å­˜åœ¨</p>';
                    const processData = window.fallbackWordDetails['Process'];
                    output += `<p>æ•°æ®é¢„è§ˆ: ${JSON.stringify(processData).substring(0, 100)}...</p>`;
                    
                    // 2. å°è¯•æ¸²æŸ“æ•°æ®
                    output += '<p>2. å¼€å§‹æ¸²æŸ“æ•°æ®...</p>';
                    renderProcessData(processData);
                    output += '<p>âœ… æ¸²æŸ“å®Œæˆ</p>';
                } else {
                    output += '<p>âŒ Process å¤‡ç”¨æ•°æ®ä¸å­˜åœ¨</p>';
                }
                
                // 3. å°è¯•åŠ è½½ JSON æ•°æ®
                output += '<p>3. å°è¯•åŠ è½½ JSON æ•°æ®...</p>';
                try {
                    const response = await fetch('./data/word-details.json');
                    output += `<p>ğŸ“¡ Fetchå“åº”çŠ¶æ€: ${response.status}</p>`;
                    if (response.ok) {
                        const data = await response.json();
                        output += '<p>âœ… JSON è§£ææˆåŠŸ</p>';
                        if (data.words && data.words['Process']) {
                            output += '<p>âœ… JSON æ•°æ®åŠ è½½æˆåŠŸï¼ŒProcessæ•°æ®å­˜åœ¨</p>';
                            output += '<p>ğŸ¨ å¼€å§‹æ¸²æŸ“Processæ•°æ®...</p>';
                            try {
                                renderProcessData(data.words['Process']);
                                output += '<p>âœ… Processæ•°æ®æ¸²æŸ“å®Œæˆ</p>';
                            } catch (renderError) {
                                output += `<p>âŒ æ¸²æŸ“é”™è¯¯: ${renderError.message}</p>`;
                            }
                        } else {
                            output += '<p>âŒ JSON ä¸­æ²¡æœ‰ Process æ•°æ®</p>';
                            output += `<p>å¯ç”¨çš„å•è¯: ${Object.keys(data.words || {}).join(', ')}</p>`;
                        }
                    } else {
                        output += `<p>âŒ JSON æ–‡ä»¶åŠ è½½å¤±è´¥ï¼ŒçŠ¶æ€ç : ${response.status}</p>`;
                    }
                } catch (error) {
                    output += `<p>âŒ JSON åŠ è½½é”™è¯¯: ${error.message}</p>`;
                    output += `<p>é”™è¯¯ç±»å‹: ${error.name}</p>`;
                    output += `<p>å½“å‰URL: ${window.location.href}</p>`;
                    output += `<p>å°è¯•çš„è·¯å¾„: ${new URL('./data/word-details.json', window.location.href).href}</p>`;
                }
                
            } catch (error) {
                output += `<p>âŒ è°ƒè¯•è¿‡ç¨‹å‡ºé”™: ${error.message}</p>`;
                console.error('è°ƒè¯•é”™è¯¯:', error);
            }
            
            debugOutput.innerHTML = output;
        }
        
        // æ¸²æŸ“ Process æ•°æ®
        function renderProcessData(wordData) {
            console.log('å¼€å§‹æ¸²æŸ“ Process æ•°æ®:', wordData);
            
            // æ·»åŠ æ¸²æŸ“çŠ¶æ€åˆ°è°ƒè¯•è¾“å‡º
            const debugOutput = document.getElementById('debugOutput');
            let currentOutput = debugOutput.innerHTML;
            
            // è®¾ç½®åŸºæœ¬ä¿¡æ¯
            const wordTitle = document.getElementById('wordTitle');
            const pronunciation = document.getElementById('pronunciation');
            const definition = document.getElementById('definition');
            
            if (wordTitle) {
                wordTitle.textContent = wordData.word || 'Process';
                currentOutput += '<p>âœ… æ ‡é¢˜è®¾ç½®å®Œæˆ</p>';
            }
            if (pronunciation) {
                pronunciation.textContent = wordData.pronunciation || '/ËˆprÉ™ÊŠses/';
                currentOutput += '<p>âœ… å‘éŸ³è®¾ç½®å®Œæˆ</p>';
            }
            if (definition) {
                definition.textContent = wordData.definition || 'A series of actions...';
                currentOutput += '<p>âœ… å®šä¹‰è®¾ç½®å®Œæˆ</p>';
            }
            
            debugOutput.innerHTML = currentOutput;
            console.log('åŸºæœ¬ä¿¡æ¯è®¾ç½®å®Œæˆ');
            
            // æ¸²æŸ“è¯æ ¹è¯æº
            if (wordData.etymology) {
                const etymologyContent = document.getElementById('etymologyContent');
                if (etymologyContent) {
                    etymologyContent.innerHTML = `
                        <p><strong>è¯æ ¹åˆ†è§£:</strong> ${wordData.etymology.breakdown}</p>
                        <p><strong>è¯æºè§£é‡Š:</strong> ${wordData.etymology.explanation}</p>
                    `;
                    console.log('è¯æ ¹è¯æºæ¸²æŸ“å®Œæˆ');
                }
            }
            
            // æ¸²æŸ“è§†è§‰æ¼”ç¤º
            if (wordData.visualDemo) {
                const processFlow = document.getElementById('processFlow');
                const visualDescription = document.getElementById('visualDescription');
                
                if (processFlow) {
                    processFlow.innerHTML = '';
                    wordData.visualDemo.steps.forEach((step, index) => {
                        const stepDiv = document.createElement('div');
                        stepDiv.className = 'process-step';
                        stepDiv.textContent = step;
                        processFlow.appendChild(stepDiv);

                        if (index < wordData.visualDemo.steps.length - 1) {
                            const arrow = document.createElement('div');
                            arrow.className = 'arrow';
                            arrow.textContent = 'â†’';
                            processFlow.appendChild(arrow);
                        }
                    });
                    console.log('è§†è§‰æ¼”ç¤ºæ¸²æŸ“å®Œæˆ');
                }
                
                if (visualDescription) {
                    visualDescription.textContent = wordData.visualDemo.description;
                }
            }
            
            // æ¸²æŸ“è®°å¿†æ•…äº‹
            if (wordData.memoryStory) {
                const memoryStory = document.getElementById('memoryStory');
                if (memoryStory) {
                    memoryStory.textContent = wordData.memoryStory;
                    console.log('è®°å¿†æ•…äº‹æ¸²æŸ“å®Œæˆ');
                }
            }
            
            // æ¸²æŸ“ä¾‹å¥
            if (wordData.examples) {
                const examplesList = document.getElementById('examplesList');
                if (examplesList) {
                    examplesList.innerHTML = '';
                    wordData.examples.forEach(example => {
                        const exampleDiv = document.createElement('div');
                        exampleDiv.className = 'example-item';
                        exampleDiv.innerHTML = `
                            <div class="example-type">${example.type}:</div>
                            <div>${example.sentence}</div>
                        `;
                        examplesList.appendChild(exampleDiv);
                    });
                    console.log('ä¾‹å¥æ¸²æŸ“å®Œæˆ');
                }
            }
            
            // æ¸²æŸ“åŒä¹‰è¯
            if (wordData.synonyms) {
                const synonymsList = document.getElementById('synonymsList');
                if (synonymsList) {
                    synonymsList.innerHTML = '';
                    wordData.synonyms.forEach(synonym => {
                        const span = document.createElement('span');
                        span.className = 'word-tag';
                        span.textContent = synonym;
                        synonymsList.appendChild(span);
                    });
                    console.log('åŒä¹‰è¯æ¸²æŸ“å®Œæˆ');
                }
            }
            
            // æ¸²æŸ“åä¹‰è¯
            if (wordData.antonyms) {
                const antonymsList = document.getElementById('antonymsList');
                if (antonymsList) {
                    antonymsList.innerHTML = '';
                    wordData.antonyms.forEach(antonym => {
                        const span = document.createElement('span');
                        span.className = 'word-tag';
                        span.textContent = antonym;
                        antonymsList.appendChild(span);
                    });
                    console.log('åä¹‰è¯æ¸²æŸ“å®Œæˆ');
                }
            }
            
            // æ¸²æŸ“å¸¸ç”¨çŸ­è¯­
            if (wordData.phrases) {
                const phrasesList = document.getElementById('phrasesList');
                if (phrasesList) {
                    phrasesList.innerHTML = '';
                    wordData.phrases.forEach(phraseObj => {
                        const phraseDiv = document.createElement('div');
                        phraseDiv.className = 'phrase-item';
                        phraseDiv.innerHTML = `<strong>${phraseObj.phrase}</strong> - ${phraseObj.meaning}`;
                        phrasesList.appendChild(phraseDiv);
                    });
                    console.log('å¸¸ç”¨çŸ­è¯­æ¸²æŸ“å®Œæˆ');
                }
            }
            
            console.log('âœ… Process æ•°æ®æ¸²æŸ“å…¨éƒ¨å®Œæˆ');
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM åŠ è½½å®Œæˆï¼Œå¼€å§‹è°ƒè¯•...');
            setTimeout(debugLoadProcess, 500); // å»¶è¿Ÿæ‰§è¡Œç¡®ä¿æ‰€æœ‰èµ„æºåŠ è½½å®Œæˆ
        });
    </script>
</body>
</html>