<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Word Detail</title>
    <link rel="stylesheet" href="../../css/detail.css">
</head>
<body>
    <button class="back-btn" onclick="window.close()">â† è¿”å›</button>
    
    <div class="card">
        <div class="header">
            <h1 class="word-title" id="wordTitle">Debug Mode</h1>
            <div class="pronunciation" id="pronunciation">è°ƒè¯•æ¨¡å¼</div>
            <div class="definition" id="definition">æ£€æŸ¥æ•°æ®åŠ è½½çŠ¶æ€</div>
        </div>
        
        <div class="content">
            <div class="section">
                <h3>ğŸ” è°ƒè¯•ä¿¡æ¯</h3>
                <div id="debugInfo">
                    <p>æ­£åœ¨æ£€æŸ¥æ•°æ®...</p>
                </div>
            </div>
            
            <div class="section etymology">
                <h3>ğŸŒ± è¯æ ¹è¯æº</h3>
                <div id="etymologyContent">ç­‰å¾…æ•°æ®åŠ è½½...</div>
            </div>
            
            <div class="visual-demo" id="visualDemo">
                <div class="gear"></div>
                <div class="process-flow" id="processFlow">
                    <!-- åŠ¨æ€ç”Ÿæˆæµç¨‹æ­¥éª¤ -->
                </div>
                <p style="margin-top: 20px; color: #4a6b7a; font-size: 1.1em;" id="visualMemory">
                    <strong>Visual Memory:</strong> <span id="visualDescription">ç­‰å¾…æ•°æ®...</span>
                </p>
            </div>
            
            <div class="section story">
                <h3>ğŸ“– Memory Story</h3>
                <p id="memoryStory">ç­‰å¾…æ•°æ®åŠ è½½...</p>
            </div>
            
            <div class="section examples">
                <h3>ğŸ“ Example Sentences</h3>
                <div id="examplesList">ç­‰å¾…æ•°æ®åŠ è½½...</div>
            </div>
            
            <div class="section synonyms-antonyms">
                <div class="syn-ant-item">
                    <h4>Synonyms</h4>
                    <div class="word-list" id="synonymsList">ç­‰å¾…æ•°æ®...</div>
                </div>
                <div class="syn-ant-item">
                    <h4>Antonyms</h4>
                    <div class="word-list" id="antonymsList">ç­‰å¾…æ•°æ®...</div>
                </div>
            </div>
            
            <div class="section phrases">
                <h3>ğŸ”¤ å¸¸ç”¨çŸ­è¯­</h3>
                <div id="phrasesList">ç­‰å¾…æ•°æ®åŠ è½½...</div>
            </div>
        </div>
    </div>

    <script src="../../js/fallback-data.js"></script>
    <script>
        // è°ƒè¯•ç‰ˆæœ¬çš„è¯¦æƒ…é¡µé¢
        console.log('=== è°ƒè¯•æ¨¡å¼å¯åŠ¨ ===');
        
        // æ£€æŸ¥å¤‡ç”¨æ•°æ®æ˜¯å¦åŠ è½½
        function checkData() {
            const debugInfo = document.getElementById('debugInfo');
            let info = '<h4>æ•°æ®æ£€æŸ¥ç»“æœï¼š</h4>';
            
            // æ£€æŸ¥ fallbackVocabulary
            if (window.fallbackVocabulary) {
                info += '<p>âœ… fallbackVocabulary å·²åŠ è½½</p>';
                info += `<p>ğŸ“Š åŒ…å« ${window.fallbackVocabulary.words.length} ä¸ªå•è¯</p>`;
                info += '<p>å•è¯åˆ—è¡¨ï¼š';
                window.fallbackVocabulary.words.forEach(word => {
                    info += `<span style="background:#7b9db8;color:white;padding:2px 8px;margin:2px;border-radius:10px;display:inline-block;">${word.word}</span>`;
                });
                info += '</p>';
            } else {
                info += '<p>âŒ fallbackVocabulary æœªåŠ è½½</p>';
            }
            
            // æ£€æŸ¥ fallbackWordDetails
            if (window.fallbackWordDetails) {
                info += '<p>âœ… fallbackWordDetails å·²åŠ è½½</p>';
                info += '<p>è¯¦ç»†æ•°æ®åŒ…å«ï¼š';
                Object.keys(window.fallbackWordDetails).forEach(word => {
                    info += `<span style="background:#6b8ba5;color:white;padding:2px 8px;margin:2px;border-radius:10px;display:inline-block;">${word}</span>`;
                });
                info += '</p>';
            } else {
                info += '<p>âŒ fallbackWordDetails æœªåŠ è½½</p>';
            }
            
            // æ£€æŸ¥URLå‚æ•°
            const urlParams = new URLSearchParams(window.location.search);
            const wordParam = urlParams.get('word');
            if (wordParam) {
                info += `<p>ğŸ¯ URLå‚æ•°: word = "${wordParam}"</p>`;
                
                // æ£€æŸ¥è¯¥å•è¯çš„æ•°æ®
                if (window.fallbackWordDetails && window.fallbackWordDetails[wordParam]) {
                    info += `<p>âœ… "${wordParam}" çš„è¯¦ç»†æ•°æ®å­˜åœ¨</p>`;
                    loadWordData(wordParam);
                } else {
                    info += `<p>âŒ "${wordParam}" çš„è¯¦ç»†æ•°æ®ä¸å­˜åœ¨</p>`;
                    info += '<p>å¯ç”¨çš„å•è¯ï¼š' + Object.keys(window.fallbackWordDetails || {}).join(', ') + '</p>';
                }
            } else {
                info += '<p>âš ï¸ æ²¡æœ‰URLå‚æ•°ï¼Œé»˜è®¤åŠ è½½ Process</p>';
                loadWordData('Process');
            }
            
            debugInfo.innerHTML = info;
        }
        
        // åŠ è½½å•è¯æ•°æ®
        function loadWordData(wordName) {
            console.log(`å°è¯•åŠ è½½å•è¯: ${wordName}`);
            
            if (!window.fallbackWordDetails || !window.fallbackWordDetails[wordName]) {
                console.error(`å•è¯ "${wordName}" çš„æ•°æ®ä¸å­˜åœ¨`);
                return;
            }
            
            const wordData = window.fallbackWordDetails[wordName];
            console.log('å•è¯æ•°æ®:', wordData);
            
            // è®¾ç½®åŸºæœ¬ä¿¡æ¯
            document.getElementById('wordTitle').textContent = wordData.word;
            document.getElementById('pronunciation').textContent = wordData.pronunciation;
            document.getElementById('definition').textContent = wordData.definition;
            
            // æ¸²æŸ“è¯æ ¹è¯æº
            if (wordData.etymology) {
                document.getElementById('etymologyContent').innerHTML = `
                    <p><strong>è¯æ ¹åˆ†è§£:</strong> ${wordData.etymology.breakdown}</p>
                    <p><strong>è¯æºè§£é‡Š:</strong> ${wordData.etymology.explanation}</p>
                `;
            }
            
            // æ¸²æŸ“è§†è§‰æ¼”ç¤º
            if (wordData.visualDemo) {
                const processFlow = document.getElementById('processFlow');
                processFlow.innerHTML = '';
                wordData.visualDemo.steps.forEach((step, index) => {
                    const stepDiv = document.createElement('div');
                    stepDiv.className = 'process-step';
                    stepDiv.textContent = step;
                    processFlow.appendChild(stepDiv);

                    if (index < wordData.visualDemo.steps.length - 1) {
                        const arrow = document.createElement('div');
                        arrow.className = 'arrow';
                        arrow.textContent = 'â†’';
                        processFlow.appendChild(arrow);
                    }
                });
                
                document.getElementById('visualDescription').textContent = wordData.visualDemo.description;
            }
            
            // æ¸²æŸ“è®°å¿†æ•…äº‹
            if (wordData.memoryStory) {
                document.getElementById('memoryStory').textContent = wordData.memoryStory;
            }
            
            // æ¸²æŸ“ä¾‹å¥
            if (wordData.examples) {
                const examplesList = document.getElementById('examplesList');
                examplesList.innerHTML = '';
                wordData.examples.forEach(example => {
                    const exampleDiv = document.createElement('div');
                    exampleDiv.className = 'example-item';
                    exampleDiv.innerHTML = `
                        <div class="example-type">${example.type}:</div>
                        <div>${example.sentence}</div>
                    `;
                    examplesList.appendChild(exampleDiv);
                });
            }
            
            // æ¸²æŸ“åŒä¹‰è¯
            if (wordData.synonyms) {
                const synonymsList = document.getElementById('synonymsList');
                synonymsList.innerHTML = '';
                wordData.synonyms.forEach(synonym => {
                    const span = document.createElement('span');
                    span.className = 'word-tag';
                    span.textContent = synonym;
                    synonymsList.appendChild(span);
                });
            }
            
            // æ¸²æŸ“åä¹‰è¯
            if (wordData.antonyms) {
                const antonymsList = document.getElementById('antonymsList');
                antonymsList.innerHTML = '';
                wordData.antonyms.forEach(antonym => {
                    const span = document.createElement('span');
                    span.className = 'word-tag';
                    span.textContent = antonym;
                    antonymsList.appendChild(span);
                });
            }
            
            // æ¸²æŸ“å¸¸ç”¨çŸ­è¯­
            if (wordData.phrases) {
                const phrasesList = document.getElementById('phrasesList');
                phrasesList.innerHTML = '';
                wordData.phrases.forEach(phraseObj => {
                    const phraseDiv = document.createElement('div');
                    phraseDiv.className = 'phrase-item';
                    phraseDiv.innerHTML = `<strong>${phraseObj.phrase}</strong> - ${phraseObj.meaning}`;
                    phrasesList.appendChild(phraseDiv);
                });
            }
            
            console.log(`âœ… "${wordName}" æ•°æ®åŠ è½½å®Œæˆ`);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œæ£€æŸ¥
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOMåŠ è½½å®Œæˆï¼Œå¼€å§‹æ£€æŸ¥æ•°æ®...');
            setTimeout(checkData, 100); // ç¨å¾®å»¶è¿Ÿç¡®ä¿æ‰€æœ‰è„šæœ¬éƒ½åŠ è½½å®Œæˆ
        });
    </script>
</body>
</html>